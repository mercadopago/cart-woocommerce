class MPErrorMessageNormalizer{static DEFAULT_ERROR_MESSAGE="empty error message";static normalize(e){return e&&e.replace(/[\t\n]/g,"").trim()||this.DEFAULT_ERROR_MESSAGE}}class MPCustomEventDispatcher{static dispatch(e,r){document.dispatchEvent(new CustomEvent(e,{detail:r}))}}class MPCheckoutErrorHandler{handle(){throw new Error("Method must be implemented")}}class MPClassicCheckoutErrorHandler extends MPCheckoutErrorHandler{#e="checkout_error";#r="form[name=checkout]";#t=".woocommerce-error";ERROR_EVENT_NAME="mp_checkout_error";handle(){document.querySelector(this.#r)&&jQuery(document.body).on(this.#e,((e,r)=>{const t=document.querySelector(this.#t),o=t?.textContent||r,s=MPErrorMessageNormalizer.normalize(o);MPCustomEventDispatcher.dispatch(this.ERROR_EVENT_NAME,{message:s})}))}}class MPOrderPayCheckoutErrorHandler extends MPCheckoutErrorHandler{#o="form#order_review";#s=".woocommerce-notices-wrapper .woocommerce-error";#E=1e3;ERROR_EVENT_NAME="mp_checkout_error";handle(){if(!document.querySelector(this.#o))return;const e=document.querySelector(this.#s);if(!e)return;const r=MPErrorMessageNormalizer.normalize(e.textContent);setTimeout((()=>{MPCustomEventDispatcher.dispatch(this.ERROR_EVENT_NAME,{message:r})}),this.#E)}}class MPBlocksCheckoutErrorHandler extends MPCheckoutErrorHandler{ERROR_EVENT_NAME="mp_checkout_error";handle(e){const r=e?.processingResponse?.paymentDetails?.message,t=MPErrorMessageNormalizer.normalize(r);MPCustomEventDispatcher.dispatch(this.ERROR_EVENT_NAME,{message:t})}}class MPCheckoutErrorDispatcher{constructor(){this.handlers=new Map([["classic",new MPClassicCheckoutErrorHandler],["orderPay",new MPOrderPayCheckoutErrorHandler],["blocks",new MPBlocksCheckoutErrorHandler]])}init(){document.addEventListener("DOMContentLoaded",(()=>{this.handlers.get("classic").handle(),this.handlers.get("orderPay").handle()}))}handleBlocksError(e){this.handlers.get("blocks").handle(e)}static dispatchEventWhenBlocksCheckoutErrorOccurred(e){(new MPCheckoutErrorDispatcher).handleBlocksError(e)}}(new MPCheckoutErrorDispatcher).init();